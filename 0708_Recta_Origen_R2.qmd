# 7.8 ¿Por qué cuando se ajusta la recta por el origen no se debe usar $R^2$? {.unnumbered}

Si se sabe que cuando $X=0$ seguro que $Y=0$ y además nuestros valores están en torno a esa zona, puede ser razonable forzar que la recta $y=b_0+b_1x$ pase por el origen[^0708_recta_origen_r2-1]. En este caso solo hay que calcular el valor de la pendiente $b_1$. Deducir su expresión es muy fácil, solo hay que minimizar: $S = \sum (y_i -b_1x_i)^2$ y, siguiendo el procedimiento habitual, tenemos: $$ \frac{\mathrm{d}S}{\mathrm{d}b_1}  = \frac{\mathrm{d}(\sum y_i^2-\sum 2y_ib_1x_i+ \sum b_1^2x_i^2)} {\mathrm{d} b_1} = -2 \sum x_iy_i +2 \sum x_i^2b_1$$

[^0708_recta_origen_r2-1]: <small>Observe que no es suficiente con estar seguros de que si $X=0$ entonces $Y=0$. Al modelar el peso en función de la estatura sabemos que si la estatura es cero, el peso también será cero, pero no ajustamos a una recta por el origen porque los valores que se ajustan --valores reales-- están lejos del origen y no se puede extrapolar la relación. </small>

Está claro que la segunda derivada es positiva (es una suma de cuadrados), por lo que tendremos un mínimo. Igualando a cero y despejando el valor de $b_1$ se obtiene: $$ b_1 = \frac{\sum x_iy_i}{\sum x_i^2} $$ Un aspecto singular de este caso es que el valor de $R^2$ no es una buena medida de calidad del ajuste. 

El primer problema surge cuando nos ponemos a calcularlo. Sabemos que $R^2$ mide la proporción en que se reduce la suma de los cuadrados de los residuos en la recta ajustada respecto a una recta que no usa la información de $X$ y que es, por tanto, una recta horizontal (la estimación del valor de $Y$ no depende del valor de $X$). En el caso de una recta ajustada sin restricciones está claro que la recta horizontal debe ser $y=\bar{y}$, de forma que la mejor estimación de $Y$ sea su valor medio. En la figura [-@fig-RectaOrigen1] tenemos un ejemplo sencillo de cálculo de $R^2$ en este caso.

![Valores de $Q_Y$ y $Q_R$ tras el ajuste por mínimos cuadrados. En este caso $R^2 = 100 \cdot (56-16)/56 = 71{,}43$](07_Fig_Regresion/0801_RectaOrigen.png){#fig-RectaOrigen1 .fig-compacta2 fig-align="center" width="90%"}

Si forzamos que la recta pase por el origen, para el cálculo de la suma de cuadrados en la recta horizontal ($Q_Y$) tenemos dos opciones:

**1. Usar** $y=\bar{y}$, igual que en la recta sin restricciones. De entrada, a esta opción se le puede poner la pega de que nosotros queremos que la recta pase por el origen y parece razonable que la recta horizontal de referencia también pase por el origen. Ignorando este aspecto, tenemos que $Q_Y$ no cambia y sigue siendo igual a 56 mientras que $Q_R$ es algo mayor (no puede ser de otra forma porque en la recta sin restricciones ese valor es el mínimo posible) y resulta ser igual a 16,56 (figura [-@fig-RectaOrigen1], derecha). Haciendo las operaciones nos queda $R^2 = 70,43$ que aunque es algo menor que en la recta sin restricciones entendemos que corresponde a un mejor ajuste.

**2. Usar** $y=0$. Esta es una recta horizontal que pasa por el origen. Cumple la misma restricción que la recta que vamos a ajustar pero los residuos en este caso pueden ser muy grandes, por lo que la disminución que se consigue con la recta ajustada también va a ser grande y, por tanto, también lo será el valor de $R^2$. En nuestro ejemplo tenemos que, calculado de esta forma, $Q_Y = 461$. El valor de $Q_R$ no cambia, por lo que tenemos que $R^2=96,41$ [-@fig-RectaOrigen2]. Esto no tiene mucho sentido, aunque así lo presentan algunos paquetes de software estadístico y también Excel (versión 2019).

![Valores de $Q_Y$ tomando como referencia la recta $y=0$ y de $Q_R$ en una recta forzada a pasar por el origen. El valor de $R^2$ sería: $100 \cdot (461-16,56)/461 = 94,41$](07_Fig_Regresion/0802_RectaOrigen.png){#fig-RectaOrigen2 .fig-compacta2 fig-align="center" width="90%"}

Con independencia de la forma como se calcule, el valor de $R^2$ cuando se fuerza que la recta pase por el origen no tiene las mismas propiedades que en el caso general ni sus valores son comparables. En particular, en el caso de la recta por el origen el valor de $R^2$ no es el cuadrado del coeficiente de correlación entre $X$ e $Y$, como sí ocurre en el caso general. Lo mejor es no usar $R^2$ en este caso y valorar la calidad del ajuste con otra medida, como la desviación típica de los residuos.
