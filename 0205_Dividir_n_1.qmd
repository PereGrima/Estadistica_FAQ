# 2.5 ¿Por qué cuando se calcula la varianza de una muestra se divide por n-1? {#n-1 .unnumbered}

Para facilitar la explicación trabajaremos con un ejemplo en el que suponemos que conocemos la población completa, un lujo que no tendremos en la práctica.. Los elementos que componen la población, junto con sus mediciones respectivas, son:

```{=html}
<div class="tabla-wrapper2">
<table class="tabla-0205_1">

<tr>
<td>(A)</td>
<td>(B)</td>
<td>(C)</td>
<td>(D)</td>
<td>(E)</td>
<td>(F)</td>
</tr>

<tr>
<td>2</td>
<td>6</td>
<td>8</td>
<td>10</td>
<td>10</td>
<td>12</td>
</tr>

 </table>
</div>
```
En primer lugar ilustraremos la propiedad de insesgamiento de un estimador en el caso de la media, con la cual estamos más familiarizados, y luego repetiremos el razonamiento para el caso que nos ocupa, el de la varianza.

La media poblacional $\mu$, correspondiente a los datos del ejemplo, es:

$$\mu = \frac{2+6+8+10+10+12}{6}=8$$

Supongamos que queremos estimar (“hacernos una idea”) el valor $\mu$, usando una muestra aleatoria de $n = 2$ unidades. En este caso, como la población consta sólo de 6 unidades, podemos hacer un listado de todas las muestras que pueden resultar al escoger dos unidades al azar. Estas muestras aparecen enumeradas en la siguiente tabla:

```{=html}
<div class="tabla-wrapper2">
<table class="tabla-0205_2">

<colgroup>
<col style="width: 16.75%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
</colgroup>

<tbody>
<tr>
<td style="text-align: left;">Muestra nº</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
<td>13</td>
<td>14</td>
<td>15</td>
</tr>

<tr>
<td>Unidades de la muestra</td>
<td>A<br>B</td>
<td>A<br>C</td>
<td>A<br>D</td>
<td>A<br>E</td>
<td>A<br>F</td>
<td>B<br>C</td>
<td>B<br>D</td>
<td>B<br>E</td>
<td>B<br>F</td>
<td>C<br>D</td>
<td>C<br>E</td>
<td>C<br>F</td>
<td>D<br>E</td>
<td>D<br>F</td>
<td>E<br>F</td>
</tr>

<tr>
<td>Valores en la muestra</td>
<td>2<br>6</td>
<td>2<br>8</td>
<td>2<br>10</td>
<td>2<br>10</td>
<td>2<br>12</td>
<td>6<br>8</td>
<td>6<br>10</td>
<td>6<br>10</td>
<td>6<br>12</td>
<td>8<br>10</td>
<td>8<br>10</td>
<td>8<br>12</td>
<td>10<br>10</td>
<td>10<br>12</td>
<td>10<br>12</td>
</tr>

<tr>
<td>Media muestral</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>6</td>
<td>7</td>
<td>7</td>
<td>8</td>
<td>8</td>
<td>9</td>
<td>9</td>
<td>9</td>
<td>10</td>
<td>10</td>
<td>11</td>
<td>11</td>
</tr>

</tbody>
</table>
</div
```
Cuando se seleccione al azar una muestra de dos unidades, el resultado será necesariamente alguna de estas 15 posibles combinaciones de 2 elementos, con su media $\bar{x}$ correspondiente.

Decimos que $\bar{x}$ es un estimador insesgado de $\mu$ si el promedio de todas las posibles medias coincide exactamente con la media de la población. Para verificarlo, hagamos el promedio de nuestras 15 posibles medias: $$ \frac{4+5+6+6+7+7+8+8+9+9+9+10+10+11+11}{15}=8 $$

El promedio coincide con $\mu$. Esto ocurre en todos los casos, independientemente del tipo de población o del tamaño de la muestra, por eso decimos que $\bar{x}$ es un estimador insesgado de $\mu$.

Veamos ahora si el estadístico: $$  S_{n}^{2}= \frac{ \sum_{i=1}^{n}{(x_i-\bar{x})^2} }{n} $$

donde $n$ es el tamaño de las muestras, es un estimador insesgado para la varianza $\sigma_{N}^{2}$, calculada como: $$  \sigma_{N}^{2}= \frac{ \sum_{i=1}^{N}{(x_i-\mu)^2} }{N} $$

donde $N$ es el tamaño de la población. Queremos saber si el promedio de los valores de $S_{n}^{2}$, para cada una de las posibles muestras, coincide con el valor de $\sigma_{N}^{2}$ y para averiguarlo, en primer lugar vamos a calcular la varianza poblacional:

$$  \sigma_{N}^{2}= \frac{(2-8)^2+(6-8)^2+(8-8)^2+...+(12-8)^2}{6} = 10,67 $$

Ahora calculamos la varianza para cada muestra de 2 unidades, con la fórmula: $$  S_{n}^{2}= \frac{ (x_1 - \bar{x})^2 + (x_2 - \bar{x})^2 }{2} $$

obteniéndose los resultados que aparecen en la siguiente tabla:

```{=html}
<div class="tabla-wrapper2">
<table class="tabla-0205_2">
<colgroup>
<col style="width: 16.75%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
<col style="width: 5.5%" />
</colgroup>

<tbody>
<tr>
<td style="text-align: left;">Muestra nº</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
<td>13</td>
<td>14</td>
<td>15</td>
</tr>

<tr>
<td>Valores en la muestra</td>
<td>2<br>6</td>
<td>2<br>8</td>
<td>2<br>10</td>
<td>2<br>10</td>
<td>2<br>12</td>
<td>6<br>8</td>
<td>6<br>10</td>
<td>6<br>10</td>
<td>6<br>12</td>
<td>8<br>10</td>
<td>8<br>10</td>
<td>8<br>12</td>
<td>10<br>10</td>
<td>10<br>12</td>
<td>10<br>12</td>
</tr>

<tr>
<td>Varianza muestral</td>
<td>4</td>
<td>9</td>
<td>16</td>
<td>16</td>
<td>25</td>
<td>1</td>
<td>4</td>
<td>4</td>
<td>9</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>

</tbody>
</table>
</div
```
Veamos si el promedio de las posibles varianzas muestrales, coincide con 10,67 que es el valor obtenido para $\sigma_{N}^{2}$.

$$ \bar{S}^2 = \frac{4+9+16+16+25+1+4+4+9+...+1}{15} = 6,4 $$

No coincide y, por tanto, $S_{n}^{2}$ no es un estimador insesgado de $\sigma_{N}^{2}$. Sin embargo $S_{n-1}^{2}$, definido de la forma: $$  S_{n-1}^{2}= \frac{ \sum_{i=1}^{n}{(x_i-\bar{x})^2} }{n-1} $$

aunque tampoco es un estimador insesgado para $\sigma_{N}^{2}$, sí lo es de $\sigma_{N-1}^{2}$ definido como: $$  \sigma_{N-1}^{2}= \frac{ \sum_{i=1}^{N-1}{(x_i-\mu)^2} }{N-1} $$

Efectivamente, $\sigma_{N-1}^2$ tiene el valor: $$  \sigma_{N-1}^{2}= \frac{(2-8)^2+(6-8)^2+(8-8)^2+...+(12-8)^2}{6-1} = 12,8 $$

Y si calculamos $S_{n-1}^{2}$ para cada una de nuestras muestras deberemos aplicar la fórmula:

$$  S_{n-1}^{2}= \frac{ (x_1 - \bar{x})^2 + (x_2 - \bar{x})^2 }{2-1} = \frac{ (x_1 - \bar{x})^2 + (x_2 - \bar{x})^2 }{1}  $$

Es decir que todos los valores de la varianza que aparecen en la tabla anterior, quedan ahora multiplicados por 2 y por lo tanto la media de las varianzas queda también multiplicada por 2, es decir:

$$ \bar{S}_{n-1}^{2}= 2\cdot 6,4 = 12,8 $$

Quizá este resultado decepcione, y hasta sorprenda, porque seguramente lo esperado era que $S_{n-1}^{2}$ fuera un estimador insesgado de $\sigma_{N}^{2}$ y no de $\sigma_{N-1}^{2}$, pero no hay que preocuparse demasiado. A efectos prácticos es casi lo mismo cuando la población es grande, ya que no vamos a estimar, a partir de una muestra, las características de una población de 6 elementos (en nuestro ejemplo esta ha sido una población “de juguete” para entender el razonamiento).

Cuando estimemos la varianza de una población se tratará de una población grande, en la que $\sigma_{N}^{2}$ será prácticamente igual a $\sigma_{N-1}^{2}$. En realidad, el caso más frecuente es tener poblaciones teóricas (infinitas), en las que es exactamente lo mismo $\sigma_{N}^{2}$ que $\sigma_{N-1}^{2}$.
